[supervisord]
nodaemon=true

[program:jupyterlab]
command=/usr/local/bin/jupyter lab --ip=0.0.0.0 --port=8888 --allow-root --no-browser
autorestart=true
startsecs=10
stopwaitsecs=10

[program:ollama]
command=ollama serve
autorestart=true
startsecs=10
stopwaitsecs=10

[program:ipfs]
command=/bin/bash -c "sleep 10 && su - deScier -c 'ipfs daemon --enable-gc --routing=dht'"
user=deScier
environment=HOME="/home/deScier",USER="deScier"
directory=/home/deScier
autorestart=true
autostart=true
startsecs=15
stopwaitsecs=10
stdout_logfile=/var/log/supervisor/ipfs.log
stderr_logfile=/var/log/supervisor/ipfs-error.log

[program:academic-platform]
command=/bin/bash -c "sleep 15 && cd /home/deScier/DeSciOS/node && DATABASE_PATH=/home/deScier/.academic/database.sqlite npm start"
user=deScier
environment=HOME="/home/deScier",USER="deScier",NODE_ENV="production",PORT="8000",IPFS_API_URL="http://localhost:5001",DATABASE_PATH="/home/deScier/.academic/database.sqlite",UPLOADS_PATH="/home/deScier/.academic/uploads",JWT_SECRET="descios-academic-platform-secret"
directory=/home/deScier/DeSciOS/node
autorestart=true
autostart=true
startsecs=20
stopwaitsecs=10
stdout_logfile=/var/log/supervisor/academic-platform.log
stderr_logfile=/var/log/supervisor/academic-platform-error.log
